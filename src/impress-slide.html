<link rel="import" href="impress-animated.html">
<polymer-element extends="impress-animated" name="impress-slide" constructor="ImpressSlide">
	<template>
		<style type="text/css">
			:host{
			  position: relative;
			  top: 0;
			  left: 0;
			  overflow: hidden;
			  display: none;
  			width: 100%;
				height: 100%;
				margin: 0;
			  -webkit-box-sizing: border-box;
			  -moz-box-sizing: border-box;
			  box-sizing: border-box;	
			  -webkit-animation: 1s both;
			  animation: 1s both;
			  -webkit-animation-name: {{ animationName }} !important;
			  animation-name: {{ animationName }} !important; 
		  }

			:host[past] {
			  /*opacity: 0;*/
			}

			:host(:host[current]) {
			  display: block;
			}

			:host[next] {
			  pointer-events: none;
			}
		</style>
		<content id="content"></content>
	</template>
	<script type="text/javascript">
		(function() {
			Polymer('impress-slide', {
				fragments: [],
				animateInFragments: [],
				animateOutFragments: [],
				curFragment: '',

				animateNextFragment: function() {
					if (this.curFragment = this.animateInFragments.shift()) {
						this.curFragment.animateIn();
						return true;
					} else if (this.curFragment = this.animateOutFragments.shift()) {
						this.curFragment.animateOut();
						return true;
					} else {
						[].map.call(this.fragments, function(el) {
							el.removeAnimations();
						});
						return false;
					}
				},

				ready: function() {
					this.fragments = this.querySelectorAll('impress-fragment');
					this.animateInFragments = [].filter.call(
						this.fragments, function(el) {
							return typeof el.animations.entrance === "string";
						});
					this.animateOutFragments = [].filter.call(
						this.fragments, function(el) {
							return typeof el.animations.exit === "string";
						});
				},
			});
		})();
	</script>
</polymer-element>